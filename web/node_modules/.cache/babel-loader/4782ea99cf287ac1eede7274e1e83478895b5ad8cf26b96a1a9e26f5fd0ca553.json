{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{useQuery}from'react-query';import axios from'axios';import{BarChart,Bar,XAxis,YAxis,CartesianGrid,Tooltip,ResponsiveContainer}from'recharts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL='http://localhost:8000/api/v1';const DashboardPage=()=>{const navigate=useNavigate();const[accessToken,setAccessToken]=useState(null);useEffect(()=>{const token=localStorage.getItem('accessToken');if(!token){navigate('/login');}else{setAccessToken(token);}},[navigate]);const{data:transactions,isLoading}=useQuery('transactions',()=>axios.get(\"\".concat(API_BASE_URL,\"/transactions/\"),{headers:{Authorization:\"Bearer \".concat(accessToken)}}),{enabled:!!accessToken});const handleLogout=()=>{localStorage.removeItem('accessToken');localStorage.removeItem('refreshToken');navigate('/login');};const totalBalance=(transactions===null||transactions===void 0?void 0:transactions.data.results.reduce((sum,t)=>sum+t.amount,0))||0;const income=(transactions===null||transactions===void 0?void 0:transactions.data.results.filter(t=>t.amount>0).reduce((sum,t)=>sum+t.amount,0))||0;const expenses=(transactions===null||transactions===void 0?void 0:transactions.data.results.filter(t=>t.amount<0).reduce((sum,t)=>sum+t.amount,0))||0;// Prepare chart data\nconst chartData=[{name:'Receitas',value:income},{name:'Despesas',value:Math.abs(expenses)}];return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Grana.AI\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-btn\",children:\"Sair\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Saldo Total\"}),/*#__PURE__*/_jsxs(\"p\",{className:totalBalance>=0?'positive':'negative',children:[\"R$ \",totalBalance.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Receitas\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"positive\",children:[\"R$ \",income.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Despesas\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"negative\",children:[\"R$ \",Math.abs(expenses).toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Vis\\xE3o Geral\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:chartData,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>\"R$ \".concat(value)}),/*#__PURE__*/_jsx(Bar,{dataKey:\"value\",fill:\"#007bff\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transactions-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Transa\\xE7\\xF5es Recentes\"}),isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Carregando...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"transactions-list\",children:transactions===null||transactions===void 0?void 0:transactions.data.results.slice(0,10).map(transaction=>/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-info\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"transaction-description\",children:transaction.description}),/*#__PURE__*/_jsx(\"p\",{className:\"transaction-date\",children:new Date(transaction.date).toLocaleDateString('pt-BR')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-amount\",children:[/*#__PURE__*/_jsxs(\"p\",{className:transaction.amount<0?'negative':'positive',children:[\"R$ \",transaction.amount.toFixed(2)]}),transaction.category&&/*#__PURE__*/_jsx(\"span\",{className:\"transaction-category\",style:{backgroundColor:transaction.category.color},children:transaction.category.name})]})]},transaction.id))})]})]});};export default DashboardPage;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useQuery","axios","BarChart","Bar","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","DashboardPage","navigate","accessToken","setAccessToken","token","localStorage","getItem","data","transactions","isLoading","get","concat","headers","Authorization","enabled","handleLogout","removeItem","totalBalance","results","reduce","sum","t","amount","income","filter","expenses","chartData","name","value","Math","abs","className","children","onClick","toFixed","width","height","strokeDasharray","dataKey","formatter","fill","slice","map","transaction","description","Date","date","toLocaleDateString","category","style","backgroundColor","color","id"],"sources":["/Users/hatusbatista/Documents/GranaApp/web/src/pages/DashboardPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useQuery } from 'react-query';\nimport axios from 'axios';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\n\nconst API_BASE_URL = 'http://localhost:8000/api/v1';\n\ninterface Transaction {\n  id: number;\n  amount: number;\n  description: string;\n  date: string;\n  category: {\n    name: string;\n    color: string;\n  } | null;\n}\n\nconst DashboardPage = () => {\n  const navigate = useNavigate();\n  const [accessToken, setAccessToken] = useState<string | null>(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem('accessToken');\n    if (!token) {\n      navigate('/login');\n    } else {\n      setAccessToken(token);\n    }\n  }, [navigate]);\n\n  const { data: transactions, isLoading } = useQuery(\n    'transactions',\n    () =>\n      axios.get<{ results: Transaction[] }>(`${API_BASE_URL}/transactions/`, {\n        headers: { Authorization: `Bearer ${accessToken}` },\n      }),\n    {\n      enabled: !!accessToken,\n    }\n  );\n\n  const handleLogout = () => {\n    localStorage.removeItem('accessToken');\n    localStorage.removeItem('refreshToken');\n    navigate('/login');\n  };\n\n  const totalBalance = transactions?.data.results.reduce((sum, t) => sum + t.amount, 0) || 0;\n  const income = transactions?.data.results.filter(t => t.amount > 0).reduce((sum, t) => sum + t.amount, 0) || 0;\n  const expenses = transactions?.data.results.filter(t => t.amount < 0).reduce((sum, t) => sum + t.amount, 0) || 0;\n\n  // Prepare chart data\n  const chartData = [\n    { name: 'Receitas', value: income },\n    { name: 'Despesas', value: Math.abs(expenses) },\n  ];\n\n  return (\n    <div className=\"dashboard-container\">\n      <header className=\"dashboard-header\">\n        <h1>Grana.AI</h1>\n        <button onClick={handleLogout} className=\"logout-btn\">Sair</button>\n      </header>\n\n      <div className=\"stats-grid\">\n        <div className=\"stat-card\">\n          <h3>Saldo Total</h3>\n          <p className={totalBalance >= 0 ? 'positive' : 'negative'}>\n            R$ {totalBalance.toFixed(2)}\n          </p>\n        </div>\n        <div className=\"stat-card\">\n          <h3>Receitas</h3>\n          <p className=\"positive\">R$ {income.toFixed(2)}</p>\n        </div>\n        <div className=\"stat-card\">\n          <h3>Despesas</h3>\n          <p className=\"negative\">R$ {Math.abs(expenses).toFixed(2)}</p>\n        </div>\n      </div>\n\n      <div className=\"chart-container\">\n        <h2>Visão Geral</h2>\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <BarChart data={chartData}>\n            <CartesianGrid strokeDasharray=\"3 3\" />\n            <XAxis dataKey=\"name\" />\n            <YAxis />\n            <Tooltip formatter={(value) => `R$ ${value}`} />\n            <Bar dataKey=\"value\" fill=\"#007bff\" />\n          </BarChart>\n        </ResponsiveContainer>\n      </div>\n\n      <div className=\"transactions-section\">\n        <h2>Transações Recentes</h2>\n        {isLoading ? (\n          <p>Carregando...</p>\n        ) : (\n          <div className=\"transactions-list\">\n            {transactions?.data.results.slice(0, 10).map((transaction) => (\n              <div key={transaction.id} className=\"transaction-item\">\n                <div className=\"transaction-info\">\n                  <p className=\"transaction-description\">{transaction.description}</p>\n                  <p className=\"transaction-date\">\n                    {new Date(transaction.date).toLocaleDateString('pt-BR')}\n                  </p>\n                </div>\n                <div className=\"transaction-amount\">\n                  <p className={transaction.amount < 0 ? 'negative' : 'positive'}>\n                    R$ {transaction.amount.toFixed(2)}\n                  </p>\n                  {transaction.category && (\n                    <span\n                      className=\"transaction-category\"\n                      style={{ backgroundColor: transaction.category.color }}\n                    >\n                      {transaction.category.name}\n                    </span>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default DashboardPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}